{"remainingRequest":"/home/admin/Documents/spring-graph-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/admin/Documents/spring-graph-vue/src/App.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/admin/Documents/spring-graph-vue/src/App.vue","mtime":1583503543573},{"path":"/home/admin/Documents/spring-graph-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/admin/Documents/spring-graph-vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/admin/Documents/spring-graph-vue/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/admin/Documents/spring-graph-vue/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/home/admin/Documents/spring-graph-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/admin/Documents/spring-graph-vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgppbXBvcnQgVnVlIGZyb20gInZ1ZSI7Ci8vIGltcG9ydCBIZWxsb1dvcmxkIGZyb20gIi4vY29tcG9uZW50cy9IZWxsb1dvcmxkLnZ1ZSI7CgovLyBBREQgVEhFIE5FVyBDT01QT05FTlRTCmltcG9ydCBVc2VyIGZyb20gIi4vY29tcG9uZW50cy9Vc2VyLnZ1ZSI7CmltcG9ydCBBZG1pbiBmcm9tICIuL2NvbXBvbmVudHMvQWRtaW4udnVlIjsKaW1wb3J0IE5hdiBmcm9tICIuL2NvbXBvbmVudHMvTmF2LnZ1ZSI7CgovLyBBREQgS0VZQ0xPQUsKaW1wb3J0IEtleWNsb2FrIGZyb20gIi4uL25vZGVfbW9kdWxlcy9rZXljbG9hay1qcy9kaXN0L2tleWNsb2FrIjsKCi8vIEFERCBBUEkKLy8gaW1wb3J0IGFwaSBmcm9tICIuL2NvbXBvbmVudHMvYXBpIjsKCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBBeGlvcyBmcm9tICJheGlvcyI7CgppbXBvcnQgeyByZXF1ZXN0IH0gZnJvbSAiZ3JhcGhxbC1yZXF1ZXN0IjsKCmV4cG9ydCBkZWZhdWx0IFZ1ZS5leHRlbmQoewogIG5hbWU6ICJBcHAiLAoKICBjb21wb25lbnRzOiB7CiAgICBVc2VyLAogICAgQWRtaW4sCiAgICBOYXYKICB9LAoKICBkYXRhOiAoKSA9PiAoewogICAgY29tcG9uZW50TmFtZTogIiIsCiAgICBwZW9wbGVBcnI6IFtdLAogICAgcGVvcGxlSGVhZGVyOiBbIklEIiwgIk5hbWUiLCAiQWRkcmVzcyIsICJQaG9uZSJdLAogICAgcm9sZTogU3RyaW5nLAogICAgaGVhZGVyTmFtZTogU3RyaW5nLAogICAgaW5pdE9wdGlvbnM6IHsKICAgICAgcmVhbG06ICJrZXljbG9hay1kZW1vIiwKICAgICAgdXJsOiAiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2F1dGgvIiwKICAgICAgY2xpZW50SWQ6ICJ2dWUtdGVzdC1hcHAiCiAgICB9LAogICAga2V5Y2xvYWs6IEtleWNsb2FrKCkKICB9KSwKICBtZXRob2RzOiB7CiAgICBsb2FkUGFnZSgpOiBhbnkgewogICAgICAvLyBUSElTIElTIFRIRSBDT1BJRUQgQ09ERSBGUk9NIFRIRSBLRVlDTE9BSyBBRE1JTklTVFJBVElPTiBDT05TT0xFLiBKVVNUIEFEQVBUIElULCBTTyBUSEFUIElUIE1BVEhFUyBUSElTIEZPUk1BVAogICAgICB0aGlzLmtleWNsb2FrID0gS2V5Y2xvYWsodGhpcy5pbml0T3B0aW9ucyk7CgogICAgICBsZXQgcm9sZXMgPSAiIjsKCiAgICAgIHRoaXMua2V5Y2xvYWsKICAgICAgICAuaW5pdCh7CiAgICAgICAgICBvbkxvYWQ6ICJsb2dpbi1yZXF1aXJlZCIKICAgICAgICB9KQogICAgICAgIC5zdWNjZXNzKChhdXRoOiBhbnkpID0+IHsKICAgICAgICAgIC8vIENIRUNLIElGIFRIRSBVU0VSIElTIEFVVEhFTlRJQ0FURUQKICAgICAgICAgIGlmICghYXV0aCkgewogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmxvZygiU1VDQ0VTU0ZVTExZIEFVVEhFTlRJQ0FURUQiKTsKCiAgICAgICAgICAgIC8vIENIRUNLIFdIQVQgUk9MRVMgVEhFWSBIQVZFIEFORCBESVNQTEFZIFRIRSBDT01QT05FTlQgQUNDT1JESU5HIFRPIFRIRSBST0xFCiAgICAgICAgICAgIHJvbGVzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmtleWNsb2FrLnRva2VuUGFyc2VkKSk7CiAgICAgICAgICAgIHRoaXMucm9sZSA9IHJvbGVzLnJlYWxtX2FjY2Vzcy5yb2xlczsKCiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50TmFtZSA9IFN0cmluZyh0aGlzLnJvbGUpOwoKICAgICAgICAgICAgdGhpcy5oZWFkZXJOYW1lID0gdGhpcy5jb21wb25lbnROYW1lID09ICJhZG1pbiIgPyAicGluayBsaWdodGVuLTMiIDogInBpbmsgZGFya2VuLTMiOwoKICAgICAgICAgICAgLy8gTUFLRSBSRVFVRVNUIENBTEwgVE8gR1JBUEhRTAogICAgICAgICAgICBjb25zdCBxdWVyeSA9IGAKICAgICAgICAgICAgICBxdWVyeSB7CiAgICAgICAgICAgICAgICAgIGdldFBlcnNvbihyb2xlOiAiJHt0aGlzLnJvbGV9IikKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICBpZCwKICAgICAgICAgICAgICAgICAgICAgIG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgICAgICAgcGhvbmUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBgOwoKICAgICAgICAgICAgcmVxdWVzdCgiaHR0cDovL2xvY2FsaG9zdDo5MDkwL2dyYXBocWwiLCBxdWVyeSkKICAgICAgICAgICAgICAudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgLy9ESVNQTEFZIERBVEEgSU4gQ09NUE9ORU5UCiAgICAgICAgICAgICAgICB0aGlzLnBlb3BsZUFyci5wdXNoKHJlcy5nZXRQZXJzb24uaWQpOwogICAgICAgICAgICAgICAgdGhpcy5wZW9wbGVBcnIucHVzaChyZXMuZ2V0UGVyc29uLm5hbWUpOwogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICByZXMuZ2V0UGVyc29uLmFkZHJlc3MgPT0gIiIgfHwKICAgICAgICAgICAgICAgICAgcmVzLmdldFBlcnNvbi5hZGRyZXNzID09ICIiCiAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgdGhpcy5wZW9wbGVBcnIucHVzaCgiQ09ORklERU5USUFMIik7CiAgICAgICAgICAgICAgICAgIHRoaXMucGVvcGxlQXJyLnB1c2goIkNPTkZJREVOVElBTCIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgdGhpcy5wZW9wbGVBcnIucHVzaChyZXMuZ2V0UGVyc29uLmFkZHJlc3MpOwogICAgICAgICAgICAgICAgICB0aGlzLnBlb3BsZUFyci5wdXNoKHJlcy5nZXRQZXJzb24ucGhvbmUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIFNFVCBUSEUgVE9LRU4gSU4gVEhFIExPQ0FMU1RPUkFHRQogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInZ1ZS10b2tlbiIsIFN0cmluZyh0aGlzLmtleWNsb2FrLnRva2VuKSk7CiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgKICAgICAgICAgICAgInZ1ZS1yZWZyZXNoLXRva2VuIiwKICAgICAgICAgICAgU3RyaW5nKHRoaXMua2V5Y2xvYWsucmVmcmVzaFRva2VuKQogICAgICAgICAgKTsKCiAgICAgICAgICAvLyBIQU5ETEUgVE9LRU4gVElNRU9VVAogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIHRoaXMua2V5Y2xvYWsKICAgICAgICAgICAgICAudXBkYXRlVG9rZW4oNzApCiAgICAgICAgICAgICAgLnN1Y2Nlc3MocmVmcmVzaGVkID0+IHsKICAgICAgICAgICAgICAgIGlmIChyZWZyZXNoZWQpIHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlRva2VuIFJlZnJlc2hlZCIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlRva2VuIE5vdCBSZWZyZXNoZWQiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIC5lcnJvcigoKSA9PiB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRmFpbGVkIFRvIFJlZnJlc2ggVG9rZW4iKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgIH0sIDYwMDAwKTsKICAgICAgICB9KQogICAgICAgIC5lcnJvcigoKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZygiQVVUSEVOVElDQVRJT04gRkFJTEVEIik7CiAgICAgICAgfSk7CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5sb2FkUGFnZSgpOwogIH0KfSk7Cg=="},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAoBA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <v-app>\n    <Nav v-bind:headerName=\"headerName\" v-bind:keycloak=\"keycloak\" />\n    <v-content>\n      <br>\n      <span class=\"display-3 font-weight-thin pa-8\">Graphql Example:</span>\n      <component\n        v-bind:is=\"componentName\"\n        v-bind:peopleArr=\"peopleArr\"\n        v-bind:peopleHeader=\"peopleHeader\"\n      />\n      <!-- <v-btn v-on:click=\"logOut\">LOGOUT</v-btn> -->\n    </v-content>\n    <!-- <v-content>\n      <HelloWorld />\n    </v-content>-->\n  </v-app>\n</template>\n\n<script lang=\"ts\">\nimport Vue from \"vue\";\n// import HelloWorld from \"./components/HelloWorld.vue\";\n\n// ADD THE NEW COMPONENTS\nimport User from \"./components/User.vue\";\nimport Admin from \"./components/Admin.vue\";\nimport Nav from \"./components/Nav.vue\";\n\n// ADD KEYCLOAK\nimport Keycloak from \"../node_modules/keycloak-js/dist/keycloak\";\n\n// ADD API\n// import api from \"./components/api\";\n\nimport axios from \"axios\";\nimport Axios from \"axios\";\n\nimport { request } from \"graphql-request\";\n\nexport default Vue.extend({\n  name: \"App\",\n\n  components: {\n    User,\n    Admin,\n    Nav\n  },\n\n  data: () => ({\n    componentName: \"\",\n    peopleArr: [],\n    peopleHeader: [\"ID\", \"Name\", \"Address\", \"Phone\"],\n    role: String,\n    headerName: String,\n    initOptions: {\n      realm: \"keycloak-demo\",\n      url: \"http://localhost:8080/auth/\",\n      clientId: \"vue-test-app\"\n    },\n    keycloak: Keycloak()\n  }),\n  methods: {\n    loadPage(): any {\n      // THIS IS THE COPIED CODE FROM THE KEYCLOAK ADMINISTRATION CONSOLE. JUST ADAPT IT, SO THAT IT MATHES THIS FORMAT\n      this.keycloak = Keycloak(this.initOptions);\n\n      let roles = \"\";\n\n      this.keycloak\n        .init({\n          onLoad: \"login-required\"\n        })\n        .success((auth: any) => {\n          // CHECK IF THE USER IS AUTHENTICATED\n          if (!auth) {\n            window.location.reload();\n          } else {\n            console.log(\"SUCCESSFULLY AUTHENTICATED\");\n\n            // CHECK WHAT ROLES THEY HAVE AND DISPLAY THE COMPONENT ACCORDING TO THE ROLE\n            roles = JSON.parse(JSON.stringify(this.keycloak.tokenParsed));\n            this.role = roles.realm_access.roles;\n\n            this.componentName = String(this.role);\n\n            this.headerName = this.componentName == \"admin\" ? \"pink lighten-3\" : \"pink darken-3\";\n\n            // MAKE REQUEST CALL TO GRAPHQL\n            const query = `\n              query {\n                  getPerson(role: \"${this.role}\")\n                    {\n                      id,\n                      name,\n                      address,\n                      phone\n                    }\n                  }\n              `;\n\n            request(\"http://localhost:9090/graphql\", query)\n              .then(res => {\n                //DISPLAY DATA IN COMPONENT\n                this.peopleArr.push(res.getPerson.id);\n                this.peopleArr.push(res.getPerson.name);\n                if (\n                  res.getPerson.address == \"\" ||\n                  res.getPerson.address == \"\"\n                ) {\n                  this.peopleArr.push(\"CONFIDENTIAL\");\n                  this.peopleArr.push(\"CONFIDENTIAL\");\n                } else {\n                  this.peopleArr.push(res.getPerson.address);\n                  this.peopleArr.push(res.getPerson.phone);\n                }\n              })\n              .catch(console.error);\n          }\n\n          // SET THE TOKEN IN THE LOCALSTORAGE\n          localStorage.setItem(\"vue-token\", String(this.keycloak.token));\n          localStorage.setItem(\n            \"vue-refresh-token\",\n            String(this.keycloak.refreshToken)\n          );\n\n          // HANDLE TOKEN TIMEOUT\n          setTimeout(() => {\n            this.keycloak\n              .updateToken(70)\n              .success(refreshed => {\n                if (refreshed) {\n                  console.log(\"Token Refreshed\");\n                } else {\n                  console.log(\"Token Not Refreshed\");\n                }\n              })\n              .error(() => {\n                console.log(\"Failed To Refresh Token\");\n              });\n          }, 60000);\n        })\n        .error(() => {\n          console.log(\"AUTHENTICATION FAILED\");\n        });\n    }\n  },\n  mounted() {\n    this.loadPage();\n  }\n});\n</script>\n"]}]}